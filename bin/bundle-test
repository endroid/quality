#!/usr/bin/env bash

set -e

curl -sS https://getcomposer.org/installer | php -- --filename=composer

rm -rf ../application

php -d memory_limit=-1 composer create-project symfony/website-skeleton ../application

cp composer ../application/composer
cp -r vendor/endroid/test/application ..

(
    cd ../application
    composer config minimum-stability dev
    composer config prefer-stable true
    composer config repositories.adventure-bundle path ../adventure-bundle
    composer require endroid/adventure-bundle:dev-master
    bin/phpunit
)
